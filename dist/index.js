!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.r(t),n.d(t,"default",function(){return u});var i={parent:window,element:null,offset:0,scrollIn:function(){console.info("Scroll in element")},scrollOut:function(){console.info("Scroll out element")}},c=function(){function e(){o(this,e),this.cache=null;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];this.callbacks=n.map(function(e){return{called:!1,name:e.name,callback:e}})}return l(e,[{key:"call",value:function(e){if(e&&e.name&&e.name!==this.cache){var t=this.callbacks.find(function(t){return t.name===e.name});t.called||(this.callbacks.forEach(function(e){e.called=!1}),t.callback(),t.called=!0,this.cache=t.name)}}}]),e}(),u=function(){function e(t){o(this,e),this.option=Object.assign(i,t),this.listener=this.listener.bind(this),this.scrollTop=0,this.elementTop=this.getElementTop(this.option.element),this.toggleFunctionManager=new c(this.option.scrollIn,this.option.scrollOut),this.elementTop&&(this.recountScroll(this.option.parent),this.init())}return l(e,[{key:"getTopCordinats",value:function(e){var t=e.getBoundingClientRect(),n=document.body,o=document.documentElement,r=window.pageYOffset||o.scrollTop||n.scrollTop,l=o.clientTop||n.clientTop||0,i=t.top+r-l;return Math.round(i)}},{key:"recountScroll",value:function(e){this.scrollTop=Math.round(e.pageYOffset)+this.option.offset}},{key:"getElementTop",value:function(e){var t=document.querySelector(e);return!!t&&Math.round(this.getTopCordinats(t))}},{key:"listener",value:function(){this.recountScroll(this.option.parent),this.scrollTop>=this.elementTop?this.toggleFunctionManager.call(this.option.scrollIn):this.toggleFunctionManager.call(this.option.scrollOut)}},{key:"init",value:function(){document.addEventListener("scroll",this.listener)}},{key:"destroy",value:function(){document.removeEventListener("scroll",this.listener)}}]),e}()}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LmpzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZGVmYXVsdHMiLCJwYXJlbnQiLCJ3aW5kb3ciLCJlbGVtZW50Iiwib2Zmc2V0Iiwic2Nyb2xsSW4iLCJjb25zb2xlIiwiaW5mbyIsInNjcm9sbE91dCIsIlRvZ2dsZUZ1bmN0aW9uTWFuYWdlciIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJjYWNoZSIsIl9sZW4iLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJjYWxsYmFja3MiLCJBcnJheSIsIl9rZXkiLCJtYXAiLCJjYWxsYmFjayIsImNhbGxlZCIsImZ1bmMiLCJmaW5kIiwiaXRlbSIsImZvckVhY2giLCJTY3JvbGxPbiIsIm9wdGlvbnMiLCJvcHRpb24iLCJhc3NpZ24iLCJsaXN0ZW5lciIsInNjcm9sbFRvcCIsImVsZW1lbnRUb3AiLCJnZXRFbGVtZW50VG9wIiwidG9nZ2xlRnVuY3Rpb25NYW5hZ2VyIiwicmVjb3VudFNjcm9sbCIsImluaXQiLCJib3giLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJib2R5IiwiZG9jdW1lbnQiLCJkb2N1bWVudEVsZW1lbnQiLCJwYWdlWU9mZnNldCIsImNsaWVudFRvcCIsInRvcCIsIk1hdGgiLCJyb3VuZCIsImVsZW1lbnROb2RlIiwicXVlcnlTZWxlY3RvciIsImdldFRvcENvcmRpbmF0cyIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxLQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBQyxRQUdBLElBQUFDLEVBQUFKLEVBQUFFLElBQ0FHLEVBQUFILEVBQ0FJLEdBQUEsRUFDQUgsWUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsR0FBMENLLFlBQUEsRUFBQUMsSUFBQUwsS0FLMUNaLEVBQUFrQixFQUFBLFNBQUFoQixHQUNBLG9CQUFBaUIsZUFBQUMsYUFDQU4sT0FBQUMsZUFBQWIsRUFBQWlCLE9BQUFDLGFBQXdEQyxNQUFBLFdBRXhEUCxPQUFBQyxlQUFBYixFQUFBLGNBQWlEbUIsT0FBQSxLQVFqRHJCLEVBQUFzQixFQUFBLFNBQUFELEVBQUFFLEdBRUEsR0FEQSxFQUFBQSxJQUFBRixFQUFBckIsRUFBQXFCLElBQ0EsRUFBQUUsRUFBQSxPQUFBRixFQUNBLEtBQUFFLEdBQUEsaUJBQUFGLFFBQUFHLFdBQUEsT0FBQUgsRUFDQSxJQUFBSSxFQUFBWCxPQUFBWSxPQUFBLE1BR0EsR0FGQTFCLEVBQUFrQixFQUFBTyxHQUNBWCxPQUFBQyxlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQXJCLEVBQUFVLEVBQUFlLEVBQUFFLEVBQUEsU0FBQUEsR0FBZ0gs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bUIiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCJjb25zdCBkZWZhdWx0cyA9IHtcbiAgcGFyZW50OiB3aW5kb3csXG4gIGVsZW1lbnQ6IG51bGwsXG4gIG9mZnNldDogMCxcbiAgc2Nyb2xsSW46IGZ1bmN0aW9uICgpIHtcbiAgICBjb25zb2xlLmluZm8oJ1Njcm9sbCBpbiBlbGVtZW50Jyk7XG4gIH0sXG4gIHNjcm9sbE91dDogZnVuY3Rpb24gKCkge1xuICAgIGNvbnNvbGUuaW5mbygnU2Nyb2xsIG91dCBlbGVtZW50Jyk7XG4gIH1cbn07XG5cbmNsYXNzIFRvZ2dsZUZ1bmN0aW9uTWFuYWdlciB7XG4gIGNvbnN0cnVjdG9yKC4uLmNhbGxiYWNrcykge1xuICAgIHRoaXMuY2FjaGUgPSBudWxsO1xuICAgIHRoaXMuY2FsbGJhY2tzID0gY2FsbGJhY2tzLm1hcChjYWxsYmFjayA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBjYWxsZWQ6IGZhbHNlLFxuICAgICAgICBuYW1lOiBjYWxsYmFjay5uYW1lLFxuICAgICAgICBjYWxsYmFja1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGNhbGwoZnVuYykge1xuICAgIGlmIChmdW5jICYmIGZ1bmMubmFtZSAmJiBmdW5jLm5hbWUgIT09IHRoaXMuY2FjaGUpIHtcbiAgICAgIGNvbnN0IGNhbGxiYWNrID0gdGhpcy5jYWxsYmFja3MuZmluZChpdGVtID0+IGl0ZW0ubmFtZSA9PT0gZnVuYy5uYW1lKTtcbiAgICAgIGlmICghY2FsbGJhY2suY2FsbGVkKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2tzLmZvckVhY2goaXRlbSA9PiB7XG4gICAgICAgICAgaXRlbS5jYWxsZWQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNhbGxiYWNrLmNhbGxiYWNrKCk7XG4gICAgICAgIGNhbGxiYWNrLmNhbGxlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuY2FjaGUgPSBjYWxsYmFjay5uYW1lO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTY3JvbGxPbiB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLm9wdGlvbiA9IE9iamVjdC5hc3NpZ24oZGVmYXVsdHMsIG9wdGlvbnMpO1xuICAgIHRoaXMubGlzdGVuZXIgPSB0aGlzLmxpc3RlbmVyLmJpbmQodGhpcyk7XG4gICAgdGhpcy5zY3JvbGxUb3AgPSAwO1xuICAgIHRoaXMuZWxlbWVudFRvcCA9IHRoaXMuZ2V0RWxlbWVudFRvcCh0aGlzLm9wdGlvbi5lbGVtZW50KTtcbiAgICB0aGlzLnRvZ2dsZUZ1bmN0aW9uTWFuYWdlciA9IG5ldyBUb2dnbGVGdW5jdGlvbk1hbmFnZXIodGhpcy5vcHRpb24uc2Nyb2xsSW4sIHRoaXMub3B0aW9uLnNjcm9sbE91dCk7XG4gICAgaWYgKHRoaXMuZWxlbWVudFRvcCkge1xuICAgICAgdGhpcy5yZWNvdW50U2Nyb2xsKHRoaXMub3B0aW9uLnBhcmVudCk7XG4gICAgICB0aGlzLmluaXQoKTtcbiAgICB9XG4gIH1cblxuICBnZXRUb3BDb3JkaW5hdHMoZWxlbWVudCkge1xuICAgIGNvbnN0IGJveCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHk7XG4gICAgY29uc3QgZG9jdW1lbnRFbGVtZW50ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O1xuICAgIGNvbnN0IHNjcm9sbFRvcCA9IHdpbmRvdy5wYWdlWU9mZnNldCB8fCBkb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wIHx8IGJvZHkuc2Nyb2xsVG9wO1xuICAgIGNvbnN0IGNsaWVudFRvcCA9IGRvY3VtZW50RWxlbWVudC5jbGllbnRUb3AgfHwgYm9keS5jbGllbnRUb3AgfHwgMDtcbiAgICBjb25zdCB0b3AgPSBib3gudG9wICsgc2Nyb2xsVG9wIC0gY2xpZW50VG9wO1xuXG4gICAgcmV0dXJuIE1hdGgucm91bmQodG9wKTtcbiAgfVxuXG4gIHJlY291bnRTY3JvbGwocGFyZW50KSB7XG4gICAgdGhpcy5zY3JvbGxUb3AgPSBNYXRoLnJvdW5kKHBhcmVudC5wYWdlWU9mZnNldCkgKyB0aGlzLm9wdGlvbi5vZmZzZXQ7XG4gIH1cblxuICBnZXRFbGVtZW50VG9wKGVsZW1lbnQpIHtcbiAgICBjb25zdCBlbGVtZW50Tm9kZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZWxlbWVudCk7XG4gICAgaWYgKGVsZW1lbnROb2RlKSB7XG4gICAgICByZXR1cm4gTWF0aC5yb3VuZCh0aGlzLmdldFRvcENvcmRpbmF0cyhlbGVtZW50Tm9kZSkpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBsaXN0ZW5lcigpIHtcbiAgICB0aGlzLnJlY291bnRTY3JvbGwodGhpcy5vcHRpb24ucGFyZW50KTtcbiAgICBpZiAodGhpcy5zY3JvbGxUb3AgPj0gdGhpcy5lbGVtZW50VG9wKSB7XG4gICAgICB0aGlzLnRvZ2dsZUZ1bmN0aW9uTWFuYWdlci5jYWxsKHRoaXMub3B0aW9uLnNjcm9sbEluKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50b2dnbGVGdW5jdGlvbk1hbmFnZXIuY2FsbCh0aGlzLm9wdGlvbi5zY3JvbGxPdXQpO1xuICAgIH1cbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5saXN0ZW5lcik7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMubGlzdGVuZXIpO1xuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9